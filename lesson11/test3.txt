Библиотека
Автор (КодАвтора, ФИО, Дата рождения)
Книги (КодКниги, КодАвтора, Название, КодИздательства, КодЖанра, Год издания)
Издательство (КодИздательства, Издательство, Город)
Выдача книг (КодВыдачи, КодКниги, КодКаталога, КодЧитателя, ДатаВыдачи, ДатаВозврата)
Жанр(КодЖанра, Название)
Читатели (КодЧитателя, КодБилета, ФИО, Адрес, Телефон, Имейл, ДатаРождения)


1.Найти количество книг разных жанров по издательствам. Результаты вывести в виде транспонированной таблицы.
в жанре можно было не фильтровать)

SELECT издательство,[детектив],[роман],[приключения]
FROM
(
  SELECT к название, и издательство, кж жанр
  FROM издательство и JOIN книги к ON и код издательство= к код издательство
  FROM книги к JOIN код жанра кж ON к код жанра= кж код жанра
  WHERE к название IS NOT NULL
) AS t1
PIVOT
( 
  COUNT(название)
  FOR жанр IN ([детектив],[роман],[приключения])
) AS PivotTable

2.ВЫбрать книги, которые еще ни разу не взяли

SELECT к.Название
FROM книги к JOIN выдача книги вк ON к код книги= вк код книги
WHERE дата выдачи IS NULL